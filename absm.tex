\begin{abstract}

Today's IoT systems include event-driven smart applications (apps) that interact
with sensors and actuators. A problem specific to IoT systems is that buggy apps, unforeseen bad app interactions, or device/communication failures, can cause unsafe and dangerous physical states. Detecting flaws that lead to such states, requires a holistic view of installed apps, component devices, their configurations, and more importantly, how they interact. In this paper, we design \sys, a novel practical system that uses model checking as a building block to reveal ``interaction-level'' flaws by identifying events that can lead the system to unsafe states. In building \sys, we design novel techniques tailored to IoT systems, to alleviate the state explosion associated with model checking. \sys also automatically translates IoT apps into a format amenable to model checking. Finally, to understand the root cause of a detected vulnerability, we design an attribution mechanism to identify problematic and potentially malicious apps. {\color{black}We evaluate \sys on the Samsung SmartThings platform. From 76 manually configured systems, \sys detects 147 vulnerabilities. We also evaluate \sys with malicious SmartThings apps from a previous effort. \sys detects the potential safety violations and also effectively attributes these apps as malicious.}

\end{abstract}
